<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FCM</title>
</head>
<script src="https://www.gstatic.com/firebasejs/5.9.2/firebase.js" />
<script src="https://www.gstatic.com/firebasejs/5.9.2/firebase-app.js" />
<script src="https://www.gstatic.com/firebasejs/5.9.2/firebase-messaging.js" />

<script th:inline="javascript">
  window.onload = function () {
    console.log('window onload');
    initiallizeFirebase();
  }

  function initiallizeFirebase() {
    const firebaseConfig = {
      apiKey: "AIzaSyBaG-SAt2hzgha2C16CNZQGnnB0qdiH7_I",
      authDomain: "to-be-healthy-417411.firebaseapp.com",
      projectId: "to-be-healthy-417411",
      storageBucket: "to-be-healthy-417411.appspot.com",
      messagingSenderId: "827137813758",
      appId: "1:827137813758:web:a36ff6e25eb30b32eb89af",
      measurementId: "G-68SZ9TBE6Y"
    };

    firebase.initializeApp(firebaseConfig);

    const messaging = firebase.messaging();

    messaging.requestPermission().then(function () {
      return messaging.getToken();
    }).then(async function (token) {
      console.log(token);
      messaging.onMessage(payload => {
        console.log(payload);
      })
    }).catch(function (err) {
      console.log('알람 허용 실패', err);
    });
  }
</script>
<body>
  <h1>hi! fcm</h1>
</body>
</html>
